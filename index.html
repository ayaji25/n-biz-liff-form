<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Redirecting to Google Form</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    function runApp() {
      liff.getProfile().then(profile => {
        const userId = liff.getDecodedIDToken().sub;
        const displayName = profile.displayName;
        const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSdhJQSyoQ1dokI0M4HMgePVnptkLPNfLCT6sFFUmTijtd9I0A/formResponse?entry.1491486634=" + encodeURIComponent(userId)
                        + "&entry.750163769=" + encodeURIComponent(displayName);
        window.location.href = formUrl;
      }).catch(err => {
        document.body.innerHTML = "<h3>エラーが発生しました：" + err + "</h3>";
      });
    }

    window.onload = function () {
      liff.init({ liffId: "2007008877-X3B245Zd" })
        .then(() => {
          if (!liff.isLoggedIn()) {
            liff.login();
          } else {
            runApp();
          }
        })
        .catch(err => {
          document.body.innerHTML = "<h3>LIFF初期化エラー：" + err + "</h3>";
        });
    };
  </script>
</head>
<body>
  <p>フォームへ移動中です...</p>
</body>
</html>
